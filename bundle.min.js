"use strict";var $note=$("#note"),writeBox=new WriteBox,$writeBox=writeBox.init(),dlgFont=new DlgFont(writeBox),$dlgFont=dlgFont.init(),menu=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",dark:!0},{title:"打开(O)...",shortcut:"Ctrl+O",dark:!0},{title:"保存(S)",shortcut:"Ctrl+S",dark:!0},{title:"另存为(A)...",shortcut:"Ctrl+Shift+S",dark:!0},{title:"hr",shortcut:"",dark:!0},{title:"页面设置(U)...",shortcut:"",dark:!0},{title:"打印(P)...",shortcut:"Ctrl+P",dark:!0},{title:"hr",shortcut:"",dark:!0},{title:"退出(X)",shortcut:"",dark:!0}],width:"202px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",dark:!1},{title:"hr",shortcut:"",dark:!0},{title:"剪切(T)",shortcut:"Ctrl+X",dark:!0},{title:"复制(C)",shortcut:"Ctrl+C",dark:!1},{title:"粘贴(P)",shortcut:"Ctrl+V",dark:!1},{title:"删除(L)",shortcut:"Del",dark:!1},{title:"hr",shortcut:"",dark:!0},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",dark:!0},{title:"查找(F)...",shortcut:"Ctrl+F",dark:!1},{title:"查找下一个(N)",shortcut:"F3",dark:!1},{title:"替换(R)...",shortcut:"Ctrl+H",dark:!0},{title:"转到(G)...",shortcut:"Ctrl+G",dark:!1},{title:"hr",shortcut:"",dark:!0},{title:"全选(A)",shortcut:"Ctrl+A",dark:!0},{title:"时间/日期(D)",shortcut:"F5",dark:!0}],width:"218px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",dark:!0},{title:"字体(F)...",shortcut:"",dark:!0,fun:dlgFont.open.bind(dlgFont)}],width:"156px"},{title:"查看(V)",menuItems:[{title:"缩放(Z)",shortcut:"",dark:!0},{title:"状态栏(S)",shortcut:"",dark:!0}],width:"138px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",dark:!0},{title:"发送反馈(F)",shortcut:"",dark:!0},{title:"hr",shortcut:"",dark:!0},{title:"关于记事本(A)",shortcut:"",dark:!0}],width:"166px"}],menubar=new Menubar,$menubar=menubar.init();function Menubar(){this.$menubar=null,this.$menus=[],this.init=function(){for(var t=$('<div class="menubar"></div>'),e=$('<ul class="menu_title">'),s=0;s<menu.length;s++){var i=$("<li>"+menu[s].title+"</li>");i.click(this.showMenu.bind(this,s)),i.mouseover(this.showMenu.bind(this,s)),e.append(i)}t.append(e);for(s=0;s<menu.length;s++){for(var n=$('<ul class="menu"></ul>'),l=0;l<menu[s].menuItems.length;l++){if("hr"==menu[s].menuItems[l].title)var a=$('<li class="menu_hr"></li>');else{if(menu[s].menuItems[l].dark)a=$('<li class="menu_item">'+menu[s].menuItems[l].title+'<span class="shortcut">'+menu[s].menuItems[l].shortcut+"</span></li>");else a=$('<li class="menu_item-no">'+menu[s].menuItems[l].title+'<span class="shortcut-no">'+menu[s].menuItems[l].shortcut+"</span></li>");menu[s].menuItems[l].fun&&a.click(menu[s].menuItems[l].fun)}n.append(a)}n.css("width",menu[s].width),n.css("left",62*s),t.append(n),this.$menus.push(n)}return this.$menubar=t},this.openMenu=-1,this.showMenu=function(t,e){if(e.stopPropagation(),"click"==e.type&&-1<this.openMenu)this.hideMenu();else if("click"==e.type||-1<this.openMenu){this.openMenu=t;for(var s=0;s<this.$menus.length;s++)s==t?this.$menus[s].addClass("active"):this.$menus[s].removeClass("active")}},this.hideMenu=function(){this.openMenu=-1;for(var t=0;t<this.$menus.length;t++)this.$menus[t].removeClass("active")}}function WriteBox(){this.$writeBox=$('<div class="editor"></div>'),this.$textarea=$('<textarea spellcheck="false" auto-size="none" wrap="off"></textarea>'),this.init=function(){return this.$writeBox.append(this.$textarea),this.$writeBox}}function DlgFont(t){this.writeBox=t,this.$textarea=t.$textarea,this.$dlg_font=null,this.$select_box_inputs=[],this.$select_box_item_lis=[[],[],[]],this.$sample_p=$("<p>AaBbYyZz</p>"),this.nowSelect=[0,0,0],this.newSelect=[0,0,0],this.fonts=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],this.styles=["常规","斜体","粗体","粗偏斜体"],this.sizes=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],this.init=function(){var t=[{title:"字体(F):",ul:this.fonts,default:2},{title:"字形(Y):",ul:this.styles,default:0},{title:"大小(S):",ul:this.sizes,default:6}],n=$('<div class="dlg_font"></div>'),l=$('<div class="dlg_font_box"></div>'),e=$('<div class="header"></div>'),s=$("<div>字体</div>"),i=$("<div>X</div>");i.click(this.close.bind(this)),e.append(s),e.append(i),e.mousedown(function(e){var s=l.position().top,i=l.position().left;0==e.button&&(n.mousemove(function(t){l.css("left",t.pageX-e.pageX+i+"px"),l.css("top",t.pageY-e.pageY+s+"px")}),n.mouseup(function(){n.off("mousemove"),n.off("mouseup")}))}),l.append(e);for(var a=$('<div class="body"></div>'),o=$('<div class="select_box"></div>'),r=0;r<t.length;r++){for(var h=$("<span>"+t[r].title+"</span>"),u=$('<input type="text">'),c=$("<ul></ul>"),d=0;d<t[r].ul.length;d++){var p=$("<li>"+t[r].ul[d]+"</li>");0==r?p.css("font-family",t[r].ul[d]):1==r&&this.changeStyle(p,d),p.click(this.selectLi.bind(this,r,d)),this.$select_box_item_lis[r].push(p),c.append(p)}this.$select_box_inputs.push(u),this.selectLi(r,t[r].default),o.append(h),o.append(u),o.append(c)}this.selectSave();var m=$('<fieldset class="sample"></fieldset>');m.append($("<legend>示例</legend>"));var f=this.$sample_p;m.append(f);var v=$('<div class="script"></div>');v.append($("<span>脚本(R):</span><br>"));var k=$("<select></select>");k.append($('<option value="西欧语言">西欧语言</option>')),k.append($('<option value="中文 GB2312">中文 GB2312</option>')),v.append(k);var _=$('<input type="button" value="确定" class="btn_ok">'),x=$('<input type="button" value="取消" class="btn_cancel">');return _.click(function(){this.selectSave(),this.close()}.bind(this)),x.click(this.close.bind(this)),a.append(o),a.append(m),a.append(v),a.append(_),a.append(x),l.append(a),n.append(l),this.$dlg_font=n},this.selectLi=function(t,e){for(var s=0;s<this.$select_box_item_lis[t].length;s++)s==e?this.$select_box_item_lis[t][s].addClass("selected"):this.$select_box_item_lis[t][s].removeClass("selected");this.newSelect[t]=e,0==t?(this.$select_box_inputs[t].val(this.fonts[e]),this.$sample_p.css("font-family",this.fonts[e])):1==t?(this.$select_box_inputs[t].val(this.styles[e]),this.changeStyle(this.$sample_p,e)):2==t&&(this.$select_box_inputs[t].val(this.sizes[e]),this.$sample_p.css("font-size",this.sizes[e]+"px"))},this.changeStyle=function(t,e){0==e?(t.css("font-style","normal"),t.css("font-weight","normal")):1==e?(t.css("font-style","italic"),t.css("font-weight","normal")):2==e?(t.css("font-style","normal"),t.css("font-weight","bold")):3==e&&(t.css("font-style","italic"),t.css("font-weight","bold"))},this.selectSave=function(){var t=this.newSelect;this.nowSelect=t,this.$textarea.css("font-family",this.fonts[t[0]]),this.changeStyle(this.$textarea,t[1]),this.$textarea.css("font-size",this.sizes[t[2]]+"px")},this.open=function(){this.$dlg_font.addClass("show")},this.close=function(){this.$dlg_font.removeClass("show")}}$note.append($menubar),$note.append($writeBox),$note.after($dlgFont),$note.click(menubar.hideMenu.bind(menubar));